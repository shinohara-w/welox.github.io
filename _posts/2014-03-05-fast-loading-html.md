---
layout: post
title: ページ読み込み速度の向上について
date: 2014-03-05
category : saitou
tags : [HTML, SEO]
---

普段意識せず書いているHTMLだが、
調べた結果以下のようなことで高速化できるらしい。
基本的なHTMLの知識があれば可能なものをいくつか紹介。



##■読み込み順を変える
全体の総量やファイル数は一緒でもブラウザの表示を優先させると体感速度が変わります。
ユーザ体験を高めるためには読み込み順にも配慮しましょう。

・CSSのを上部に配置。
<head>直下に<link rel='stylesheet' type='text/css' href='/css/hoge.css'>cssを配置する。

・</body>直前にJavascriptを配置
<script type='text/javascript' src='/js/hoge.js'></script>
(※正常に機能するか必ず確認。)
特にモバイルデバイスのように低速な回線が想定される場合、この手法は効果があります。



##■HTMLをスリム化する
・CSSやJavascriptは全て外部ファイル化する。
外部ファイル化することにより、キャッシュの効果を得れるため、
再来訪でコンテンツが更新されてもCSSが更新されていないケースでより高速化されます。
更新されていた場合HTMLの再読込が発生しますが
外部リンクは固定で頻繁に更新されない場合が多くキャッシュが使用され、無駄が省かれます。



##■DNSルックアップを減らす
・複数のドメインを使用しない。
イメージファイルの参照先などが複数のドメインをまたいでいると、
ドメインの参照時間がそのドメイン数分必要になります。
特に理由が無いのに複数のドメインに参照先を分割するのは避けましょう。



##■外部ファイルを圧縮する（minify）。
・余分な改行、空白、タブ、コメント行などを減らすだけでも大きな効果があります。（難読化）
これをしない理由は、「難読化」、人の目では編集不可能な1行の文字列になってしまうことです。
メンテナンスがほぼ不可能であるため、オリジナル→圧縮の作業が必要になります。
[圧縮ツール](例)
http://compressor.ebiene.de



##HTMLの構造を簡素化する。
・シンプルなHTML構造にする。
タグの入れ子関係は複雑にする程、ブラウザの解釈に時間が掛かります。
意図していないのに複雑になる場合もあります。
例えば広告を貼ると広告の内部が複雑化している、ソーシャルマークのボタン内部の構造が複雑、等です。
そうした運用環境を想定すると広告回りや外部ファイルの読み込み部分、
Ajaxが入るJavascript部分などは、よりシンプルにしたほうが良いでしょう。



##■エラーを無くす
・404 Not Found を無くす。
404 Not Found は大きく表示を遅らせる原因になります。
例えばそれが外部ドメインである場合、
DNSルックアップ→サーバ通信→待ち時間→Not Found受信と必要以上に多くのリソースを消費します。

・HTML文法エラーを無くす
文法エラーの多くはブラウザが問題を補完しようとして
より多くのリソースを消費します。
問題を引き起こす原因ともなるので修正しましょう。

・Javascriptエラーを無くす。
  Javascriptエラーも多くの無駄が発生します。
Javascriptの要求→サーバ通信→ファイルダウンロード→スクリプト実行→失敗→エラーと、
こちらも必要以上に多くのリソースを消費します。

・favicon.icoを設置する
favicon.icoは常に要求されます。Not Foundが返されることが多いのですが
「設定を忘れる」事が多い、存在すら知らなかったという事もあるでしょう。
しかし、ブラウザはバックグラウンドでfavicon.icoを要求しています。真っ先にキャッシュさせましょう。

・空のimgタグを使用しない
<img src=”">はブラウザによって異なる挙動をし想定外の問題を引き起こします。
この書き方は「何も無い」とは理解しません。（※各ブラウザによって挙動は異なります。）

